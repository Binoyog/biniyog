<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>My Task</title>

<style>
body{
    margin:0;
    font-family:Arial, sans-serif;
    background:#87CEEB;
}
.header{
    background:#0288d1;
    color:#fff;
    text-align:center;
    padding:15px;
    font-size:22px;
}
.card{
    background:#fff;
    margin:20px;
    padding:20px;
    border-radius:12px;
}
.card h3{
    margin-top:0;
    color:#0288d1;
}
.balance{
    font-size:18px;
    font-weight:bold;
    color:green;
}
</style>
</head>

<body>

<div class="header">My Task</div>

<div class="card" id="taskBox">
    ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...
</div>

<script>
let balance = Number(localStorage.getItem("balance")) || 0;
let plan = JSON.parse(localStorage.getItem("activePlan"));

function saveBalance(val){
    localStorage.setItem("balance", val);
}

// üî• DAILY INCOME SYSTEM
function dailyIncomeCheck(){

    if(!plan){
        document.getElementById("taskBox").innerHTML = "‚ùå ‡¶ï‡ßã‡¶®‡ßã ‡¶è‡¶ï‡¶ü‡¶ø‡¶≠ ‡¶™‡ßç‡¶≤‡¶æ‡¶® ‡¶®‡ßá‡¶á";
        return;
    }

    let today = new Date().toDateString();
    let lastPaid = localStorage.getItem("lastIncomeDate");

    let endDate = new Date(plan.endDate);
    let now = new Date();

    // ‚õî ‡¶™‡ßç‡¶≤‡¶æ‡¶® ‡¶∂‡ßá‡¶∑
    if(now > endDate){
        document.getElementById("taskBox").innerHTML = `
        <h3>${plan.name}</h3>
        <p>‡¶™‡ßç‡¶≤‡¶æ‡¶® ‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø: ‡ß≥${plan.price}</p>
        <p>‡¶Æ‡ßá‡ßü‡¶æ‡¶¶ ‡¶∂‡ßá‡¶∑ ‡¶π‡ßü‡ßá‡¶õ‡ßá</p>
        <p class="balance">‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏: ‡ß≥${balance}</p>`;
        return;
    }

    // ‚úÖ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶¶‡¶ø‡¶® ‡¶è‡¶ï‡¶¨‡¶æ‡¶∞ ‡¶á‡¶®‡¶ï‡¶æ‡¶Æ ‡¶Ø‡ßã‡¶ó
    if(lastPaid !== today){
        balance += plan.dailyIncome;
        saveBalance(balance);
        localStorage.setItem("lastIncomeDate", today);
    }

    document.getElementById("taskBox").innerHTML = `
        <h3>${plan.name}</h3>
        <p>‡¶™‡ßç‡¶≤‡¶æ‡¶® ‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø: ‡ß≥${plan.price}</p>
        <p>‡¶ï‡ßá‡¶®‡¶æ‡¶∞ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ: ${plan.buyDate}</p>
        <p>‡¶Æ‡ßá‡ßü‡¶æ‡¶¶ ‡¶∂‡ßá‡¶∑: ${plan.endDate}</p>
        <p>‡¶¶‡ßà‡¶®‡¶ø‡¶ï ‡¶Ü‡ßü: ‡ß≥${plan.dailyIncome}</p>
        <p class="balance">‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏: ‡ß≥${balance}</p>
    `;
}

dailyIncomeCheck();
</script>

</body>
</html>
